language: php

php:
  - 5.4

services:
  - mysql

# faster builds on new travis setup not using sudo
sudo: false

# cache vendor dirs
cache:
  directories:
    - vendor

before_install:
  - mysql -e "create database IF NOT EXISTS kuhiw_test;" -u root
  - mysql -u root kuhiw_test < database/kuhiw_test.sql

# install dependencies
install:
  - composer install

before_script:
  - cp config.example.php config.php
  - php -S localhost:8000 &
  - sleep 3

script: vendor/bin/phpunit

env:
  global:
    - secure: BpfrZAxyaWtRxVWla//uCdGQn3tyJ9jJHh3P+gVSmCtMapNWZ76bZ8zN39+EpZ8kAwXxx6HYRQNeJWfVsm7L6oipa4ZOioaHciNs0Tj8u/o1mZEtJbtU/BKJMR3nYvhiKSfj4hF8yBdiThPjWoCNuu2OXADs0bKmEJJkx4nrbNWJkVK9pVuc1oTu0nikv5mP5Gw/rBSrvtopqSHvhma1W5YiKTpn8lM9KMBZasAyQMw53LCWwSCM7ZshWdjXVj3ch+kX6oVHpo2ArKEZeSgMbzo8/YHU+t9MPj8320e2HPSzPp6YTd33yN3By3QX15HhFDKt2CtZEXVvOwrw9UhA6W4jZy3bkjzUZyWIuWnGkSsFwJrseQsnk5D3dhKYCOxP3zUUhxY3u5Z1zIsz0sjCZYWOCimacvzj3myCfQBWFu9i9QIEjm4r9wMhld9/97I3r079GlWDuHc8N3xK2W2i9/ZcIcmvTiweO9GWyb1i8WT7nrAvlUCqqGo9jHpgSV0L3YI10LdgbjZmHHHHiHK6cgN+flYhKZ6CNheCeTKQvmKj+2BOMlYpsKp8+FXqcdyq74lJqojzH3TS8VRKLZ8G03g2atP9wk2vDFvtbxccpFclk8o5gZOEAX7m8PhGcP46oT3POdasFJZbYhluyq5DuBd/t6aB+xqgdiPD1OgnJRA=
    - secure: GpeBes8gc1weenpV+qwtyIBtvIc9EnokfCbBQ6IWMa3OHT8WOk2IoDbL531AmusfEInEwPsjub21vhXBq3BeAtSuHPYQP5T62Sht4wi6YA4MKKZqjkzkK1gcxRNShItz4fPigfBzqi6C32nJfrEHAYAyJGPy7gQlBcLMScoEQ1dEww23XMZ8C+OdPSmVD9T9dJCamzv59nfSESC7PWCgEi0fPHlVFek10pfmvjajy65sp0QTJv4y5e07kh4fsyoGVXvlljEtk816oWnOfz3wfWyX4D+kPfViWUD3DjOwMCHRZny/jjzB81DPr8nzi6nkhzS1q3TE3JLpY0mdWJAFuLWFU+Z5cQ3wp8kS4PJjc5oL/fb37N62a1Pa5CUcVAn7SxM1APv/2utONtdWiZP+shgDqJVWi8edOuDxS5z0X4toP5ZLO+C5xwHQFUi5vSunPl/ZWV0f376JDPKx4jCIB4J5tnpaT1JD4s1MAXDCP8bQCKAj3/UcisQcWvPFcxfgTponPDpoJ/AFzkJChHs3i0yI9qMSURl842CItLZ2jAuRIxFALYcCGRDA7FSvE9Cm0M+1B8yGs/ffYodPnQe1m2bMTcV548VwHqlRzmHNpf6M9+ubh8cWZVDJ+EK9DvUhWfX/pDkBnRKGSxgZk4iubyjo9ISh2iYDt7vyM9IEVqY=
    - secure: nLtSMxEiwKIEqDvnHmgYMLSOhu9KGoKLbwAN+33mrNXzdZH3FsTDNyxsDlJyUI46iPkygw6pO8CBqlHKCCYhEu7hjiWLJqX+s8Wvgi+RKweXVOcZko0thfuF7YU9JX3gvmR0iq3d1E3dZVq51+RhGcjli2xpubA8k1SmcfLg+cQS6wkJFN+VAxKQ5YGpwAdOzBB/M528rUIiH+NzY9VeewUBGhLqsoJDlcccZvY5ENbeT8hLuWq+ap6eE6k9/Kvm5k0LART8rtYWWHFAHD5A/wMhty+nLtXPrt+xcVmLJXJvf5eGp5ErRmXvkmFoZLT+vNAYxqzgLtQ3RsT56sUq7ZYIkYb8APSkUkI2NXi5JYTMJprJGlXGaMx19UGzRfuHvN7mmRmLOM0RTjxH/kVWPah4Ju7cEJ622rY5ZuJaMzEKX37N7RzQHp9Xl5bRirPIE24U9qMMawW2LFgUouNWcbO/AzacmOPtLhTb4Kkgs9OvWi1I6X4k4eFK0+pAPyjDh/Cc59iL3pdNXoZVAb9R8krKJRDngXojvnOOoXs2mm1g/un7vtkEY1ysE2cC60RS2RwrKoVHk1A0kYAxhLRMI3WU5rY0QkTkebj2YN8G2OOQ0zqLMnlIYfG5se+m3E+khuhDG5y6QV2j3aJ+pGbUuOCyBxsAr5BExTtY/GxYHH0=
    - secure: DD1U595gg7Xmjtgh6LwwLE7uxW3GxQwBfY6Q3oyZ/+CehH2nkeV1diWg6SJ+LSIHfQtgNJ66dTCepVQvVqFcbfl5rkfGop3JLINsq9Tu11X8D0j8QOzHPBHrfMauQdlwrAWrlB1Y/SG59eGNgf26LrkMCd7jQ9Jj1R9RY7OzkBFVp37wDygBm43Ix2Y93xXAJvSSU/phIIlrJJ/WSUSrbXaavDyx0l38JK94F7UpONS3F7o/5uKl2ZT7ZcHyV+9SR+UmWlywYD8PjBc/kaUg2/6r9J6X3mVtDatpUZqLthzIlQXOFxbrairCgS+PU4wxZGu0JtRa3ix9Z5iwYUOLF9vXOLo+r1a5/Wx16Sh4+tGPW5KmDMfaF0P4Nb/Zvn/EnS7UNtsPZEJaW+2sTAlKhDlwJFzOT73njjejplgxALbx1HyCXKE1LJjf74UJ8xdBDsMfmIRqlbUbSsRicMkeY6UWrkq454NbBpkxS6jIzTDw5/KvsMVvCK5dWJ0/QoKIT4eEFMvX3rHBXV38jLyJhcWAJuj21SvjBMVyICuSdNWnHF16VBwu0W6AS7Ea7FrsmbTEffoVKCMVdSS3GkMwh37zYIAeI0Wej/E7U+1e5g8ONM3ohlXUd7fRNwc4OFvwpXO8zrJLpM20jJEZB5XAo+99gynaDFS3HeCch8ydKD0=

after_success:
  - gulp deploy --user $FTP_USER --password $FTP_PASSWORD --host $FTP_HOST --path $FTP_PATH